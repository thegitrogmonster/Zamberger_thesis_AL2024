## Split of the dataset

The data includes information 'type', which carries information about the environmental storage condition. Since we want to model each of these storage conditions separately, we will investigate this informational variable.
separating the data based on the 'type'
```{r data-types}
summary(data$type)
```
Most of the measurements are either coming from living trees, or construction wood. 

```{r train-test-split}

set.seed(202375)

# Use 70% of dataset as training set and remaining 30% for testing
sample <- sample(c(TRUE, FALSE), nrow(data), replace=TRUE, prob=c(0.7,0.3))
train  <- data[sample, ]
test   <- data[!sample, ]


# the dimensions of the datasets should be 
dim(test)
dim(train)
```


## PLSR Model 

Partial least squares regression (PLSR) is a multivariate regression method, which tries to find latent variables to predict a response from a (relatively) large number of variables. The Method identifies iterativly the variable with the highest covariance with the predictor and continues with the residuals. ???

WIKIPEDIA: 

"PLS is composed of iteratively repeating the following steps k times (for k components):

finding the directions of maximal covariance in input and output space
performing least squares regression on the input score
deflating the input *X* and/or target *Y*."

The Vignette for the pls package can be accessed at the cran website (https://cran.r-project.org/web/packages/pls/vignettes/pls-manual.pdf)



```{r pls}
#install pls package (if not already installed) 
	# install.packages("pls")

# load pls package
library(pls)

 # gas1 <- plsr(octane ~ NIR, ncomp = 10, data = gasTrain, validation = "LOO")
	# gas1 : model 
	# octane ~ NIR					model definition
	# ncomp									number of components used for model creation
	# data = gasTrain,			the part/split of the dataset used for training
	# validation = "LOO"		Leave one out 

pls_model <- plsr(year ~ . - tree - Origin - type, data = train, ncomp = 100, validation = "LOO")
	#	creates a pls model to predict year, without the variables tree, Origin, and type

summary(pls_model)

plot(RMSEP(pls_model), legendpos = "topright")

#  pairwise plot of the score values for the three first components
plot(pls_model, plottype = "scores", comps = 1:3)

# extracting the explained variance of the individual components
explvar(pls_model)
	# the first 9 components each explain >1% of the variance of the model

# loadings plot

summary(pls_model)
pls_model$terms
plot(pls_model, "loadings", comps = 1:2, legendpos = "topleft", labels = "numbers", xlab = "nm")
abline(h = 0)

```

